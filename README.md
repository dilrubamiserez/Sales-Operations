#  üìä Sales Operations Pipeline Analytics ‚Äî SQL Query Library

A comprehensive collection of MySQL queries for analyzing sales pipeline data, enabling data-driven decisions across forecasting, rep performance, lead source optimization, and operational automation.

---

## üóÇÔ∏è Repository Structure

```
‚îú‚îÄ‚îÄ sales_pipeline_queries.sql            # Core pipeline & win/loss analysis
‚îú‚îÄ‚îÄ deals_stuck_over_7_days.sql           # Deals stuck in stages > 7 days
‚îú‚îÄ‚îÄ won_vs_lost_percentage.sql            # Close won vs lost % over time periods
‚îú‚îÄ‚îÄ lost_reasons_and_weekly_deals.sql     # Top loss reasons & weekly deal creation
‚îú‚îÄ‚îÄ mom_deal_creation_vs_max.sql          # Month-over-month deal creation trends
‚îú‚îÄ‚îÄ pipeline_coverage_by_rep.sql          # Pipeline coverage & time bucket analysis
‚îú‚îÄ‚îÄ commit_accuracy_analysis.sql          # Forecast commit accuracy deep-dive
‚îú‚îÄ‚îÄ ytd_won_lost_by_rep.sql              # YTD won/lost values per sales rep
‚îú‚îÄ‚îÄ executive_deep_dive_insights.sql      # Executive-level risk & insight queries
‚îú‚îÄ‚îÄ advanced_lead_source_analysis.sql     # Advanced lead source performance analysis
‚îú‚îÄ‚îÄ sales_rep_automation_queries.sql      # Automation queries to reduce manual rep work
‚îî‚îÄ‚îÄ README.md
```

---

## üìã Prerequisites

- **MySQL 8.0+** (required for CTEs, window functions like `LAG()`, `RANK()`, `ROW_NUMBER()`)
- Database: `retail_sales`
- Table: `sales pipeline funnel nested`

---

## üóÉÔ∏è Data Schema

| Column | Type | Description |
|--------|------|-------------|
| `Opportunity_ID` | TEXT | Unique deal identifier |
| `Opportunity_Name` | TEXT | Deal name |
| `Sales_Rep` | TEXT | Assigned sales representative |
| `Region` | TEXT | Geographic region |
| `Product_Line` | TEXT | Product category |
| `Industry` | TEXT | Customer industry |
| `Stage` | TEXT | Current pipeline stage |
| `Deal_Size` | INT | Deal value |
| `Win_Probability` | INT | Estimated win probability (0-100) |
| `Created_Date` | TEXT | Date deal was created |
| `Last_Activity_Date` | TEXT | Date of last rep activity |
| `Expected_Close_Date` | TEXT | Projected close date |
| `Close_Date` | TEXT | Actual close date |
| `Days_in_Stage` | INT | Days in current stage |
| `Account_Name` | TEXT | Customer account name |
| `Account_Tier` | TEXT | Account tier (Enterprise, Mid-Market, SMB) |
| `Lead_Source` | TEXT | Origin of the lead |
| `Forecast_Category` | TEXT | Forecast classification (Commit, Best Case, etc.) |
| `Deal_Type` | TEXT | New business, upsell, cross-sell, etc. |
| `Quota_Contribution` | DOUBLE | Quota target for the deal |
| `Reason_Lost` | TEXT | Reason deal was lost |
| `Competitor_Name` | TEXT | Competitor involved (if any) |
| `Campaign_Name` | TEXT | Marketing campaign associated |
| `Currency` | TEXT | Deal currency |
| `Is_Stalled` | TEXT | Whether deal is stalled (TRUE/FALSE) |
| `Deal_Status` | TEXT | Current status (Open, Won, Lost) |
| `Rep_Tenure_Months` | INT | Rep experience in months |
| `Sales_Cycle_Days` | INT | Total days from creation to close |

---

#stment.

| Dimension | Key Metric |
|-----------|-----------|
| Multi-touch attribution | Stage conversion rates per source |
| Velocity | Revenue per day (speed √ó value) |
| Decay rate | Stall rate and total waste % |
| Deal type fit | New business vs upsell mix |
| Account tier | Enterprise % and revenue per enterprise lead |
| Campaign ROI | Revenue per deal generated by campaign |
| Seasonality | Best/worst months per source |
| Competitive exposure | Competitive loss rate per source |
| Composite scorecard | A‚ÄìD grade across all dimensions |

---

### 11. `sales_rep_automation_queries.sql` ‚Äî Operational Automation
15 queries designed to power automated workflows and reduce manual rep work.

| Module | Purpose |
|--------|---------|
| **Deal Health Scoring** | 0‚Äì100 score per deal based on 6 weighted risk signals |
| **Smart Priority Queue** | Daily ranked action list with suggested next steps |
| **Auto-Forecast Suggestions** | Data-driven forecast category recommendations with mismatch flags |
| **Pipeline Gap Alerts** | Detects missing short-term or mid-term pipeline per rep |
| **Stale Deal Reminders** | Stage-specific inactivity thresholds with escalation levels |
| **Loss Pattern Coaching** | Matches open deals to historical losing patterns with coaching prompts |
| **Weekly Auto-Summary** | Full weekly digest per rep: created, won, lost, stalled |
| **Smart Deal Routing** | Rep capability profiles for optimal deal assignment |

---



## ‚öôÔ∏è Customization

### Date Formats
All queries assume `YYYY-MM-DD` format for date columns stored as TEXT. If your format differs, update the `STR_TO_DATE()` format strings:

```sql
-- Default
STR_TO_DATE(Close_Date, '%Y-%m-%d')

-- For MM/DD/YYYY
STR_TO_DATE(Close_Date, '%m/%d/%Y')
```

### Thresholds
Key thresholds you may want to adjust:

| Parameter | Default | Location |
|-----------|---------|----------|
| Stuck deal days | 7 days | `deals_stuck_over_7_days.sql` |
| Pipeline coverage healthy ratio | 3x quota | `pipeline_coverage_by_rep.sql` |
| Commit accuracy profiles | 80/60/40% | `commit_accuracy_analysis.sql` |
| Deal size tiers | 10K/50K/100K | Multiple files |
| Stage inactivity thresholds | 3‚Äì7 days | `sales_rep_automation_queries.sql` |
| Health score weights | See scoring logic | `sales_rep_automation_queries.sql` |

